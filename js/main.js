!function(c){var I={};function g(n){if(I[n])return I[n].exports;var r=I[n]={i:n,l:!1,exports:{}};return c[n].call(r.exports,r,r.exports,g),r.l=!0,r.exports}g.m=c,g.c=I,g.d=function(c,I,n){g.o(c,I)||Object.defineProperty(c,I,{enumerable:!0,get:n})},g.r=function(c){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},g.t=function(c,I){if(1&I&&(c=g(c)),8&I)return c;if(4&I&&"object"==typeof c&&c&&c.__esModule)return c;var n=Object.create(null);if(g.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:c}),2&I&&"string"!=typeof c)for(var r in c)g.d(n,r,function(I){return c[I]}.bind(null,r));return n},g.n=function(c){var I=c&&c.__esModule?function(){return c.default}:function(){return c};return g.d(I,"a",I),I},g.o=function(c,I){return Object.prototype.hasOwnProperty.call(c,I)},g.p="",g(g.s=0)}([function(module,exports,__webpack_require__){"use strict";eval('\r\n\r\nif ("serviceWorker" in navigator) {\r\n  window.addEventListener("load", function () {\r\n    navigator.serviceWorker.register("serviceworker.js").then(\r\n      function (registration) {\r\n        console.log(\r\n          "ServiceWorker registration successful with scope: ",\r\n          registration.scope\r\n        );\r\n      },\r\n      function (err) {\r\n        console.log("ServiceWorker registration failed: ", err);\r\n      }\r\n    );\r\n  });\r\n}\r\nconsole.log(`it works`);\r\n\r\nconst ASTEROID_NUMBER = 2;\r\nconst ASTEROID_SIZE = 50;\r\nconst ASTEROID_SPEED = 40;\r\nconst ASTEROID_VERT = 10;\r\nconst ASTEROID_JAGGENDESS = 0.5;\r\nconst BLINK = 0.1;\r\nconst FPS = 30;\r\nconst GAME_LIVE = 3;\r\nconst INVISIBILITY = 3;\r\nconst LASER_MAX = 120;\r\nconst LASER_SPEED = 500;\r\nconst POINTS_FOR_LARGE_ASTEROID = 10;\r\nconst POINTS_FOR_SMALL_ASTEROID = 20;\r\nconst SHIP_SIZE = 30;\r\nconst SHIP_FORWARD = 5;\r\nconst SHIP_EXPLODEDURATION = 1;\r\nconst TURN_SPEED = 270;\r\nconst TEXT_FADE_TIME = 3;\r\n\r\nlet asteroids = [];\r\nlet canvas = document.getElementById("gameCanvas");\r\nlet ctx = canvas.getContext("2d");\r\nlet hue = 0;\r\nlet level;\r\nlet lives = 3;\r\nlet livesColour;\r\nlet pause = false;\r\nlet ship;\r\nlet text;\r\nlet textAlpha;\r\nlet score;\r\n\r\nlet crushing = new soundEffect("assets/sounds/Crushing.wav", 1.0, 5);\r\nlet shoot = new soundEffect("assets/sounds/Shoot.wav", 0.4, 15);\r\nlet shipReturn = new soundEffect("assets/sounds/Fast.wav", 1.0, 5);\r\nlet shipBlowingUp = new soundEffect("assets/sounds/Ship_Explosion.wav");\r\nlet rocketThruster = new soundEffect("assets/sounds/Rocket_Thrusters.wav");\r\nlet tada = new soundEffect("assets/sounds/Tada.wav", 0.5, 1);\r\n\r\nfunction soundEffect(src, soundVolume = 1.0, maxSeries = 1) {\r\n  let shootSeries = this.shootSeries;\r\n  let streams = this.streams;\r\n  shootSeries = 1;\r\n  streams = [];\r\n  for (let i = 0; i <= maxSeries; i++) {\r\n    streams.push(new Audio(src));\r\n    streams[i].volume = soundVolume;\r\n  }\r\n  this.play = function () {\r\n    shootSeries = (shootSeries + 1) % maxSeries;\r\n    streams[shootSeries].play();\r\n  };\r\n  this.stop = function () {\r\n    streams[shootSeries].pause();\r\n    streams[shootSeries].currentTime = 0;\r\n  };\r\n}\r\n\r\nnewGame();\r\n\r\nfunction StartStop() {\r\n  window.setInterval(() => {\r\n    if (!pause) {\r\n      UPDATE();\r\n    }\r\n  }, 30);\r\n}\r\nStartStop();\r\n\r\ndocument.addEventListener("keydown", keyDown);\r\ndocument.addEventListener("keyup", keyUp);\r\n\r\nfunction keyDown(e) {\r\n  if (ship.dead) {\r\n    return;\r\n  }\r\n  hue = hue + 10;\r\n  switch (e.keyCode) {\r\n    case 32:\r\n      shootLaser();\r\n      break;\r\n    case 37:\r\n      ship.rotate = ((TURN_SPEED / 180) * Math.PI) / FPS;\r\n      break;\r\n    case 38:\r\n      ship.moveForward = true;\r\n      break;\r\n    case 39:\r\n      ship.rotate = ((-TURN_SPEED / 180) * Math.PI) / FPS;\r\n      break;\r\n    case 40:\r\n      ship.moveReturn = true;\r\n      break;\r\n    case 80:\r\n      pause = !pause;\r\n      break;\r\n    default:\r\n      break;\r\n  }\r\n}\r\n\r\nfunction keyUp(e) {\r\n  if (ship.dead) {\r\n    return;\r\n  }\r\n  switch (e.keyCode) {\r\n    case 32:\r\n      ship.canShoot = true;\r\n      break;\r\n    case 37:\r\n      ship.rotate = 0;\r\n      break;\r\n    case 38:\r\n      ship.moveForward = false;\r\n      break;\r\n    case 39:\r\n      ship.rotate = 0;\r\n      break;\r\n    case 40:\r\n      ship.moveReturn = false;\r\n      break;\r\n    default:\r\n      break;\r\n  }\r\n}\r\n\r\nfunction newGame() {\r\n  level = 0;\r\n  score = 0;\r\n  lives = GAME_LIVE;\r\n  ship = newShip();\r\n  nextLevel();\r\n}\r\n\r\nfunction gameOver() {\r\n  ship.dead = true;\r\n  text = "Game Over";\r\n  textAlpha = 1.0;\r\n}\r\n\r\nfunction nextLevel() {\r\n  text = "Level " + (level + 1);\r\n  textAlpha = 1.0;\r\n  createAsteroids();\r\n  tada.play();\r\n}\r\n\r\nfunction drawShip(x, y, a, colour = "white") {\r\n  ctx.strokeStyle = colour;\r\n  ctx.lineWidth = SHIP_SIZE / FPS;\r\n  ctx.beginPath();\r\n  ctx.moveTo(\r\n    x + (4 / 3) * ship.r * Math.cos(a),\r\n    y - (4 / 3) * ship.r * Math.sin(a)\r\n  );\r\n  ctx.lineTo(\r\n    x - ship.r * ((2 / 3) * Math.cos(a) + Math.sin(a)),\r\n    y + ship.r * ((2 / 3) * Math.sin(a) - Math.cos(a))\r\n  );\r\n  ctx.lineTo(\r\n    x - ship.r * ((2 / 3) * Math.cos(a) - Math.sin(a)),\r\n    y + ship.r * ((2 / 3) * Math.sin(a) + Math.cos(a))\r\n  );\r\n  ctx.closePath();\r\n  ctx.stroke();\r\n}\r\n\r\nfunction newShip() {\r\n  return {\r\n    x: Math.floor(Math.random() * canvas.width),\r\n    y: Math.floor(Math.random() * canvas.height),\r\n    r: SHIP_SIZE / 2,\r\n    a: Math.PI / 2,\r\n    blinkNum: 30,\r\n    blinkTime: 3,\r\n    canShoot: true,\r\n    dead: false,\r\n    exploadingTime: 0,\r\n    forward: {\r\n      x: 0,\r\n      y: 0,\r\n    },\r\n    lasers: [],\r\n    moveForward: false,\r\n    moveReturn: false,\r\n    motion: 0.9,\r\n    rotate: 0,\r\n  };\r\n}\r\n\r\nfunction createAsteroids() {\r\n  asteroids = [];\r\n  let x, y;\r\n  for (let i = 0; i < ASTEROID_NUMBER + level; i++) {\r\n    do {\r\n      x = Math.floor(Math.random() * canvas.width);\r\n      y = Math.floor(Math.random() * canvas.height);\r\n    } while (safetyBuffer(ship.x, ship.y, x, y) < ASTEROID_SIZE * 2 + ship.r);\r\n    asteroids.push(newAsteroid(x, y, Math.ceil(ASTEROID_SIZE / 2)));\r\n  }\r\n}\r\n\r\nfunction newAsteroid(x, y, r) {\r\n  let asteroidLevel = 1 + 0.1 * level;\r\n  let asteroid = {\r\n    x: x,\r\n    y: y,\r\n    vertically: Math.random() * 2 + ASTEROID_VERT,\r\n    xv:\r\n      ((Math.random() * ASTEROID_SPEED * asteroidLevel) / FPS) *\r\n      (Math.random() < 0.5 ? 1 : -1),\r\n    yv:\r\n      ((Math.random() * ASTEROID_SPEED * asteroidLevel) / FPS) *\r\n      (Math.random() < 0.5 ? 1 : -1),\r\n    r: r,\r\n    a: Math.PI * 2,\r\n    jaggedness: [],\r\n  };\r\n\r\n  for (let i = 0; i < ASTEROID_VERT; i++) {\r\n    asteroid.jaggedness.push(\r\n      Math.random() * ASTEROID_JAGGENDESS * 2 + 1 - ASTEROID_JAGGENDESS\r\n    );\r\n  }\r\n  return asteroid;\r\n}\r\n\r\nfunction destroyAsteroid(index) {\r\n  let x = asteroids[index].x;\r\n  let y = asteroids[index].y;\r\n  let r = asteroids[index].r;\r\n  crushing.play();\r\n\r\n  if (r == Math.ceil(ASTEROID_SIZE / 2)) {\r\n    score = score + POINTS_FOR_LARGE_ASTEROID;\r\n    asteroids.push(newAsteroid(x, y, Math.ceil(ASTEROID_SIZE / 4)));\r\n    asteroids.push(newAsteroid(x, y, Math.ceil(ASTEROID_SIZE / 4)));\r\n  } else {\r\n    score = score + POINTS_FOR_SMALL_ASTEROID;\r\n  }\r\n  asteroids.splice(index, 1);\r\n  if (asteroids.length === 0) {\r\n    level++;\r\n    nextLevel();\r\n  }\r\n}\r\n\r\nfunction explodeShip() {\r\n  ship.exploadingTime = Math.floor(SHIP_EXPLODEDURATION * FPS);\r\n  shipBlowingUp.play();\r\n}\r\n\r\nfunction safetyBuffer(x1, y1, x2, y2) {\r\n  let distansBetweenPoints = Math.sqrt(\r\n    Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)\r\n  );\r\n  return distansBetweenPoints;\r\n}\r\n\r\nfunction shootLaser() {\r\n  if (ship.canShoot) {\r\n    ship.lasers.push({\r\n      x: ship.x + (4 / 3) * ship.r * Math.cos(ship.a),\r\n      y: ship.y - (4 / 3) * ship.r * Math.sin(ship.a),\r\n      xv: (LASER_SPEED * Math.cos(ship.a)) / 50,\r\n      yv: -(LASER_SPEED * Math.sin(ship.a)) / 50,\r\n    });\r\n    shoot.play();\r\n  }\r\n  ship.canShoot = false;\r\n}\r\n\r\nfunction UPDATE() {\r\n  let blinkingOn = ship.blinkNum % INVISIBILITY === 0;\r\n  let exploding = ship.exploadingTime > 0;\r\n\r\n  // Draw Space\r\n  ctx.fillStyle = "black";\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n  // Draw the ship\r\n  if (!exploding) {\r\n    if (blinkingOn && !ship.dead) {\r\n      drawShip(ship.x, ship.y, ship.a);\r\n    }\r\n\r\n    // Blinking On\r\n    if (ship.blinkNum > 0) {\r\n      ship.blinkTime--;\r\n      if (ship.blinkTime === 0) {\r\n        ship.blinkTime = Math.floor(BLINK * FPS);\r\n        ship.blinkNum--;\r\n      }\r\n    }\r\n  }\r\n  // Explode ship\r\n  else {\r\n    ctx.beginPath();\r\n    ctx.arc(ship.x, ship.y, ship.r * 1, 7, Math.PI * 2, false);\r\n    ctx.fill();\r\n    ctx.fillStyle = "red";\r\n    ctx.beginPath();\r\n    ctx.arc(ship.x, ship.y, ship.r * 1.4, Math.PI * 2, false);\r\n    ctx.fill();\r\n    ctx.fillStyle = "orange";\r\n    ctx.beginPath();\r\n    ctx.arc(ship.x, ship.y, ship.r * 1.1, Math.PI * 2, false);\r\n    ctx.fill();\r\n    ctx.fillStyle = "yellow";\r\n    ctx.beginPath();\r\n    ctx.arc(ship.x, ship.y, ship.r * 0.8, Math.PI * 2, false);\r\n    ctx.fill();\r\n    ctx.fillStyle = "white";\r\n    ctx.beginPath();\r\n    ctx.arc(ship.x, ship.y, ship.r * 0.5, Math.PI * 2, false);\r\n    ctx.fill();\r\n  }\r\n\r\n  // Move forward in space\r\n  if (ship.moveForward) {\r\n    ship.forward.x += (SHIP_FORWARD * Math.cos(ship.a)) / 10;\r\n    ship.forward.y += (SHIP_FORWARD * Math.sin(ship.a)) / 10;\r\n    rocketThruster.play();\r\n\r\n    // Draw Turbo Buster\r\n    if (!exploding && blinkingOn) {\r\n      ctx.fillStyle = `hsl(${hue}, 100%, 50%)`;\r\n      ctx.strokeStyle = "yellow";\r\n      ctx.lineWidth = SHIP_SIZE / 15;\r\n      ctx.beginPath();\r\n      ctx.moveTo(\r\n        ship.x - ship.r * ((2 / 3) * Math.cos(ship.a) + 0.7 * Math.sin(ship.a)),\r\n        ship.y + ship.r * ((2 / 3) * Math.sin(ship.a) - 0.7 * Math.cos(ship.a))\r\n      );\r\n      ctx.lineTo(\r\n        ship.x - ship.r * 2 * Math.cos(ship.a),\r\n        ship.y + ship.r * 2 * Math.sin(ship.a)\r\n      );\r\n      ctx.lineTo(\r\n        ship.x - ship.r * ((2 / 3) * Math.cos(ship.a) - 0.7 * Math.sin(ship.a)),\r\n        ship.y + ship.r * ((2 / 3) * Math.sin(ship.a) + 0.7 * Math.cos(ship.a))\r\n      );\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      ctx.stroke();\r\n    }\r\n  }\r\n  // Move return in space\r\n  else if (ship.moveReturn && blinkingOn) {\r\n    ship.forward.y -= (SHIP_FORWARD * Math.sin(ship.a)) / 10;\r\n    ship.forward.x -= (SHIP_FORWARD * Math.cos(ship.a)) / 10;\r\n    shipReturn.play();\r\n\r\n    // Draw buster in return\r\n    if (!exploding) {\r\n      ctx.fillStyle = `hsl(${hue}, 100%, 50%)`;\r\n      ctx.strokeStyle = "yellow";\r\n      ctx.lineWidth = SHIP_SIZE / 15;\r\n      ctx.beginPath();\r\n      ctx.moveTo(\r\n        ship.x - ship.r * ((2 / 3) * Math.cos(ship.a) + 0.7 * Math.sin(ship.a)),\r\n        ship.y + ship.r * ((2 / 3) * Math.sin(ship.a) - 0.7 * Math.cos(ship.a))\r\n      );\r\n      ctx.lineTo(\r\n        ship.x - ship.r * Math.cos(ship.a),\r\n        ship.y + ship.r * Math.sin(ship.a)\r\n      );\r\n      ctx.lineTo(\r\n        ship.x - ship.r * ((2 / 3) * Math.cos(ship.a) - 0.7 * Math.sin(ship.a)),\r\n        ship.y + ship.r * ((2 / 3) * Math.sin(ship.a) + 0.7 * Math.cos(ship.a))\r\n      );\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      ctx.stroke();\r\n    }\r\n  } else {\r\n    ship.forward.x -= (ship.motion * ship.forward.x) / 5;\r\n    ship.forward.y -= (ship.motion * ship.forward.y) / 5;\r\n    rocketThruster.stop();\r\n    // shipReturn.stop();\r\n  }\r\n\r\n  // Draw Laser\r\n  for (let i = 0; i < ship.lasers.length; i++) {\r\n    ctx.fillStyle = "magenta";\r\n    ctx.beginPath();\r\n    ctx.arc(\r\n      ship.lasers[i].x,\r\n      ship.lasers[i].y,\r\n      SHIP_SIZE / 2,\r\n      Math.PI * 2,\r\n      0,\r\n      true\r\n    );\r\n    ctx.fill();\r\n  }\r\n  for (let i = 0; i < ship.lasers.length; i++) {\r\n    ship.lasers[i].x += ship.lasers[i].xv;\r\n    ship.lasers[i].y += ship.lasers[i].yv;\r\n  }\r\n\r\n  // Draw level text\r\n  if (textAlpha >= 0) {\r\n    ctx.textAlign = "center";\r\n    ctx.textBaseline = "middle";\r\n    ctx.fillStyle = "rgba(200, 200, 200, " + textAlpha + ")";\r\n    ctx.font = "normal 32px algerian ";\r\n    ctx.fillText(text, canvas.width / 2, canvas.height * 0.1);\r\n    textAlpha = textAlpha - 1.0 / TEXT_FADE_TIME / FPS;\r\n  } else if (ship.dead) {\r\n    newGame();\r\n  }\r\n\r\n  // Draw lives\r\n  for (let i = 0; i < lives; i++) {\r\n    livesColour = exploding && i === lives - 1 ? "green" : "lime";\r\n    drawShip(\r\n      SHIP_SIZE + i * SHIP_SIZE * 1.2,\r\n      SHIP_SIZE,\r\n      0.5 * Math.PI,\r\n      livesColour\r\n    );\r\n  }\r\n\r\n  // Draw Score\r\n  ctx.textAlign = "right";\r\n  ctx.textBaseline = "right";\r\n  ctx.fillStyle = "rgba(200, 200, 200)";\r\n  ctx.font = "normal 18px arial";\r\n  ctx.fillText("Score: " + score, canvas.width - SHIP_SIZE, SHIP_SIZE);\r\n\r\n  // Detect laser hits on asteroids\r\n  let asteroid_x, asteroid_y, asteroid_r, laser_x, laser_y;\r\n  for (let i = asteroids.length - 1; i >= 0; i--) {\r\n    asteroid_x = asteroids[i].x;\r\n    asteroid_y = asteroids[i].y;\r\n    asteroid_r = asteroids[i].r;\r\n\r\n    for (let j = ship.lasers.length - 1; j >= 0; j--) {\r\n      laser_x = ship.lasers[j].x;\r\n      laser_y = ship.lasers[j].y;\r\n\r\n      if (safetyBuffer(asteroid_x, asteroid_y, laser_x, laser_y) < asteroid_r) {\r\n        ship.lasers.splice(j, 1);\r\n        destroyAsteroid(i, 1);\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  // Draw asteriods\r\n  let x, y, r, a, vert, jaggedness;\r\n  for (let i = 0; i < asteroids.length; i++) {\r\n    ctx.strokeStyle = `hsl(${hue}, 100%, 50%)`;\r\n    ctx.lineWidth = SHIP_SIZE / 20;\r\n    x = asteroids[i].x;\r\n    y = asteroids[i].y;\r\n    a = asteroids[i].a;\r\n    r = asteroids[i].r;\r\n    vert = asteroids[i].vertically;\r\n    jaggedness = asteroids[i].jaggedness;\r\n    ctx.beginPath();\r\n    ctx.moveTo(\r\n      x + r * jaggedness[0] * Math.cos(a),\r\n      y + r * jaggedness[0] * Math.sin(a)\r\n    );\r\n    for (let j = 1; j < vert; j++) {\r\n      ctx.lineTo(\r\n        x + r * jaggedness[j] * Math.cos(a + (j * Math.PI * 2) / vert),\r\n        y + r * jaggedness[j] * Math.sin(a + (j * Math.PI * 2) / vert)\r\n      );\r\n    }\r\n    ctx.closePath();\r\n    ctx.stroke();\r\n  }\r\n\r\n  // Check for collision\r\n  if (!exploding) {\r\n    if (ship.blinkNum === 0) {\r\n      for (let i = 0; i < asteroids.length; i++) {\r\n        if (\r\n          safetyBuffer(ship.x, ship.y, asteroids[i].x, asteroids[i].y) <\r\n          ship.r + asteroids[i].r\r\n        ) {\r\n          explodeShip();\r\n          destroyAsteroid(i);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Rotate Ship\r\n    ship.a = ship.a + ship.rotate;\r\n\r\n    // Motion Ship\r\n    ship.x = ship.x + ship.forward.x;\r\n    ship.y = ship.y - ship.forward.y;\r\n  } else {\r\n    ship.exploadingTime--;\r\n    if (ship.exploadingTime === 0) {\r\n      lives--;\r\n      if (lives === 0) {\r\n        gameOver();\r\n      } else {\r\n        ship = newShip();\r\n      }\r\n    }\r\n  }\r\n\r\n  // Edge of screen\r\n  if (ship.x < 0 - ship.r) {\r\n    ship.x = canvas.width + ship.r;\r\n  } else if (ship.x > canvas.width + ship.r) {\r\n    ship.x = 0 - ship.r;\r\n  }\r\n  if (ship.y < 0 - ship.r) {\r\n    ship.y = canvas.height + ship.r;\r\n  } else if (ship.y > canvas.height + ship.r) {\r\n    ship.y = 0 - ship.r;\r\n  }\r\n\r\n  // Move the asteroids\r\n  for (let i = 0; i < asteroids.length; i++) {\r\n    asteroids[i].x = asteroids[i].x + asteroids[i].xv / 2;\r\n    asteroids[i].y = asteroids[i].y + asteroids[i].yv * 2;\r\n\r\n    // Edge of screen asteroids\r\n    if (asteroids[i].x < 0 - asteroids[i].r) {\r\n      asteroids[i].x = canvas.width + asteroids[i].r;\r\n    } else if (asteroids[i].x > canvas.width + asteroids[i].r) {\r\n      asteroids[i].x = 0 - asteroids[i].r;\r\n    }\r\n    if (asteroids[i].y < 0 - asteroids[i].r) {\r\n      asteroids[i].y = canvas.height + asteroids[i].r;\r\n    } else if (asteroids[i].y > canvas.height + asteroids[i].r) {\r\n      asteroids[i].y = 0 - asteroids[i].r;\r\n    }\r\n  }\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvanMvbWFpbi5qcz85MjkxIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFlOztBQUVmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLGdCQUFnQjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLDZCQUE2QjtBQUM5QztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGlCQUFpQixtQkFBbUI7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDZCQUE2QixJQUFJO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSw2QkFBNkIsSUFBSTtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsaUJBQWlCLHdCQUF3QjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsd0JBQXdCO0FBQ3pDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQSxpQkFBaUIsV0FBVztBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esb0NBQW9DLFFBQVE7QUFDNUM7QUFDQTtBQUNBOztBQUVBLHdDQUF3QyxRQUFRO0FBQ2hEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQixzQkFBc0I7QUFDdkMsNkJBQTZCLElBQUk7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLFVBQVU7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsc0JBQXNCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQSxpQkFBaUIsc0JBQXNCO0FBQ3ZDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoXCJ1c2Ugc3RyaWN0XCIpO1xyXG5cclxuaWYgKFwic2VydmljZVdvcmtlclwiIGluIG5hdmlnYXRvcikge1xyXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWdpc3RlcihcInNlcnZpY2V3b3JrZXIuanNcIikudGhlbihcclxuICAgICAgZnVuY3Rpb24gKHJlZ2lzdHJhdGlvbikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFxyXG4gICAgICAgICAgXCJTZXJ2aWNlV29ya2VyIHJlZ2lzdHJhdGlvbiBzdWNjZXNzZnVsIHdpdGggc2NvcGU6IFwiLFxyXG4gICAgICAgICAgcmVnaXN0cmF0aW9uLnNjb3BlXHJcbiAgICAgICAgKTtcclxuICAgICAgfSxcclxuICAgICAgZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiU2VydmljZVdvcmtlciByZWdpc3RyYXRpb24gZmFpbGVkOiBcIiwgZXJyKTtcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9KTtcclxufVxyXG5jb25zb2xlLmxvZyhgaXQgd29ya3NgKTtcclxuXHJcbmNvbnN0IEFTVEVST0lEX05VTUJFUiA9IDI7XHJcbmNvbnN0IEFTVEVST0lEX1NJWkUgPSA1MDtcclxuY29uc3QgQVNURVJPSURfU1BFRUQgPSA0MDtcclxuY29uc3QgQVNURVJPSURfVkVSVCA9IDEwO1xyXG5jb25zdCBBU1RFUk9JRF9KQUdHRU5ERVNTID0gMC41O1xyXG5jb25zdCBCTElOSyA9IDAuMTtcclxuY29uc3QgRlBTID0gMzA7XHJcbmNvbnN0IEdBTUVfTElWRSA9IDM7XHJcbmNvbnN0IElOVklTSUJJTElUWSA9IDM7XHJcbmNvbnN0IExBU0VSX01BWCA9IDEyMDtcclxuY29uc3QgTEFTRVJfU1BFRUQgPSA1MDA7XHJcbmNvbnN0IFBPSU5UU19GT1JfTEFSR0VfQVNURVJPSUQgPSAxMDtcclxuY29uc3QgUE9JTlRTX0ZPUl9TTUFMTF9BU1RFUk9JRCA9IDIwO1xyXG5jb25zdCBTSElQX1NJWkUgPSAzMDtcclxuY29uc3QgU0hJUF9GT1JXQVJEID0gNTtcclxuY29uc3QgU0hJUF9FWFBMT0RFRFVSQVRJT04gPSAxO1xyXG5jb25zdCBUVVJOX1NQRUVEID0gMjcwO1xyXG5jb25zdCBURVhUX0ZBREVfVElNRSA9IDM7XHJcblxyXG5sZXQgYXN0ZXJvaWRzID0gW107XHJcbmxldCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdhbWVDYW52YXNcIik7XHJcbmxldCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG5sZXQgaHVlID0gMDtcclxubGV0IGxldmVsO1xyXG5sZXQgbGl2ZXMgPSAzO1xyXG5sZXQgbGl2ZXNDb2xvdXI7XHJcbmxldCBwYXVzZSA9IGZhbHNlO1xyXG5sZXQgc2hpcDtcclxubGV0IHRleHQ7XHJcbmxldCB0ZXh0QWxwaGE7XHJcbmxldCBzY29yZTtcclxuXHJcbmxldCBjcnVzaGluZyA9IG5ldyBzb3VuZEVmZmVjdChcImFzc2V0cy9zb3VuZHMvQ3J1c2hpbmcud2F2XCIsIDEuMCwgNSk7XHJcbmxldCBzaG9vdCA9IG5ldyBzb3VuZEVmZmVjdChcImFzc2V0cy9zb3VuZHMvU2hvb3Qud2F2XCIsIDAuNCwgMTUpO1xyXG5sZXQgc2hpcFJldHVybiA9IG5ldyBzb3VuZEVmZmVjdChcImFzc2V0cy9zb3VuZHMvRmFzdC53YXZcIiwgMS4wLCA1KTtcclxubGV0IHNoaXBCbG93aW5nVXAgPSBuZXcgc291bmRFZmZlY3QoXCJhc3NldHMvc291bmRzL1NoaXBfRXhwbG9zaW9uLndhdlwiKTtcclxubGV0IHJvY2tldFRocnVzdGVyID0gbmV3IHNvdW5kRWZmZWN0KFwiYXNzZXRzL3NvdW5kcy9Sb2NrZXRfVGhydXN0ZXJzLndhdlwiKTtcclxubGV0IHRhZGEgPSBuZXcgc291bmRFZmZlY3QoXCJhc3NldHMvc291bmRzL1RhZGEud2F2XCIsIDAuNSwgMSk7XHJcblxyXG5mdW5jdGlvbiBzb3VuZEVmZmVjdChzcmMsIHNvdW5kVm9sdW1lID0gMS4wLCBtYXhTZXJpZXMgPSAxKSB7XHJcbiAgbGV0IHNob290U2VyaWVzID0gdGhpcy5zaG9vdFNlcmllcztcclxuICBsZXQgc3RyZWFtcyA9IHRoaXMuc3RyZWFtcztcclxuICBzaG9vdFNlcmllcyA9IDE7XHJcbiAgc3RyZWFtcyA9IFtdO1xyXG4gIGZvciAobGV0IGkgPSAwOyBpIDw9IG1heFNlcmllczsgaSsrKSB7XHJcbiAgICBzdHJlYW1zLnB1c2gobmV3IEF1ZGlvKHNyYykpO1xyXG4gICAgc3RyZWFtc1tpXS52b2x1bWUgPSBzb3VuZFZvbHVtZTtcclxuICB9XHJcbiAgdGhpcy5wbGF5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgc2hvb3RTZXJpZXMgPSAoc2hvb3RTZXJpZXMgKyAxKSAlIG1heFNlcmllcztcclxuICAgIHN0cmVhbXNbc2hvb3RTZXJpZXNdLnBsYXkoKTtcclxuICB9O1xyXG4gIHRoaXMuc3RvcCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHN0cmVhbXNbc2hvb3RTZXJpZXNdLnBhdXNlKCk7XHJcbiAgICBzdHJlYW1zW3Nob290U2VyaWVzXS5jdXJyZW50VGltZSA9IDA7XHJcbiAgfTtcclxufVxyXG5cclxubmV3R2FtZSgpO1xyXG5cclxuZnVuY3Rpb24gU3RhcnRTdG9wKCkge1xyXG4gIHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICBpZiAoIXBhdXNlKSB7XHJcbiAgICAgIFVQREFURSgpO1xyXG4gICAgfVxyXG4gIH0sIDMwKTtcclxufVxyXG5TdGFydFN0b3AoKTtcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGtleURvd24pO1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwga2V5VXApO1xyXG5cclxuZnVuY3Rpb24ga2V5RG93bihlKSB7XHJcbiAgaWYgKHNoaXAuZGVhZCkge1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBodWUgPSBodWUgKyAxMDtcclxuICBzd2l0Y2ggKGUua2V5Q29kZSkge1xyXG4gICAgY2FzZSAzMjpcclxuICAgICAgc2hvb3RMYXNlcigpO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgMzc6XHJcbiAgICAgIHNoaXAucm90YXRlID0gKChUVVJOX1NQRUVEIC8gMTgwKSAqIE1hdGguUEkpIC8gRlBTO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgMzg6XHJcbiAgICAgIHNoaXAubW92ZUZvcndhcmQgPSB0cnVlO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgMzk6XHJcbiAgICAgIHNoaXAucm90YXRlID0gKCgtVFVSTl9TUEVFRCAvIDE4MCkgKiBNYXRoLlBJKSAvIEZQUztcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlIDQwOlxyXG4gICAgICBzaGlwLm1vdmVSZXR1cm4gPSB0cnVlO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgODA6XHJcbiAgICAgIHBhdXNlID0gIXBhdXNlO1xyXG4gICAgICBicmVhaztcclxuICAgIGRlZmF1bHQ6XHJcbiAgICAgIGJyZWFrO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24ga2V5VXAoZSkge1xyXG4gIGlmIChzaGlwLmRlYWQpIHtcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgc3dpdGNoIChlLmtleUNvZGUpIHtcclxuICAgIGNhc2UgMzI6XHJcbiAgICAgIHNoaXAuY2FuU2hvb3QgPSB0cnVlO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgMzc6XHJcbiAgICAgIHNoaXAucm90YXRlID0gMDtcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlIDM4OlxyXG4gICAgICBzaGlwLm1vdmVGb3J3YXJkID0gZmFsc2U7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSAzOTpcclxuICAgICAgc2hpcC5yb3RhdGUgPSAwO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgNDA6XHJcbiAgICAgIHNoaXAubW92ZVJldHVybiA9IGZhbHNlO1xyXG4gICAgICBicmVhaztcclxuICAgIGRlZmF1bHQ6XHJcbiAgICAgIGJyZWFrO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gbmV3R2FtZSgpIHtcclxuICBsZXZlbCA9IDA7XHJcbiAgc2NvcmUgPSAwO1xyXG4gIGxpdmVzID0gR0FNRV9MSVZFO1xyXG4gIHNoaXAgPSBuZXdTaGlwKCk7XHJcbiAgbmV4dExldmVsKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdhbWVPdmVyKCkge1xyXG4gIHNoaXAuZGVhZCA9IHRydWU7XHJcbiAgdGV4dCA9IFwiR2FtZSBPdmVyXCI7XHJcbiAgdGV4dEFscGhhID0gMS4wO1xyXG59XHJcblxyXG5mdW5jdGlvbiBuZXh0TGV2ZWwoKSB7XHJcbiAgdGV4dCA9IFwiTGV2ZWwgXCIgKyAobGV2ZWwgKyAxKTtcclxuICB0ZXh0QWxwaGEgPSAxLjA7XHJcbiAgY3JlYXRlQXN0ZXJvaWRzKCk7XHJcbiAgdGFkYS5wbGF5KCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRyYXdTaGlwKHgsIHksIGEsIGNvbG91ciA9IFwid2hpdGVcIikge1xyXG4gIGN0eC5zdHJva2VTdHlsZSA9IGNvbG91cjtcclxuICBjdHgubGluZVdpZHRoID0gU0hJUF9TSVpFIC8gRlBTO1xyXG4gIGN0eC5iZWdpblBhdGgoKTtcclxuICBjdHgubW92ZVRvKFxyXG4gICAgeCArICg0IC8gMykgKiBzaGlwLnIgKiBNYXRoLmNvcyhhKSxcclxuICAgIHkgLSAoNCAvIDMpICogc2hpcC5yICogTWF0aC5zaW4oYSlcclxuICApO1xyXG4gIGN0eC5saW5lVG8oXHJcbiAgICB4IC0gc2hpcC5yICogKCgyIC8gMykgKiBNYXRoLmNvcyhhKSArIE1hdGguc2luKGEpKSxcclxuICAgIHkgKyBzaGlwLnIgKiAoKDIgLyAzKSAqIE1hdGguc2luKGEpIC0gTWF0aC5jb3MoYSkpXHJcbiAgKTtcclxuICBjdHgubGluZVRvKFxyXG4gICAgeCAtIHNoaXAuciAqICgoMiAvIDMpICogTWF0aC5jb3MoYSkgLSBNYXRoLnNpbihhKSksXHJcbiAgICB5ICsgc2hpcC5yICogKCgyIC8gMykgKiBNYXRoLnNpbihhKSArIE1hdGguY29zKGEpKVxyXG4gICk7XHJcbiAgY3R4LmNsb3NlUGF0aCgpO1xyXG4gIGN0eC5zdHJva2UoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gbmV3U2hpcCgpIHtcclxuICByZXR1cm4ge1xyXG4gICAgeDogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY2FudmFzLndpZHRoKSxcclxuICAgIHk6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNhbnZhcy5oZWlnaHQpLFxyXG4gICAgcjogU0hJUF9TSVpFIC8gMixcclxuICAgIGE6IE1hdGguUEkgLyAyLFxyXG4gICAgYmxpbmtOdW06IDMwLFxyXG4gICAgYmxpbmtUaW1lOiAzLFxyXG4gICAgY2FuU2hvb3Q6IHRydWUsXHJcbiAgICBkZWFkOiBmYWxzZSxcclxuICAgIGV4cGxvYWRpbmdUaW1lOiAwLFxyXG4gICAgZm9yd2FyZDoge1xyXG4gICAgICB4OiAwLFxyXG4gICAgICB5OiAwLFxyXG4gICAgfSxcclxuICAgIGxhc2VyczogW10sXHJcbiAgICBtb3ZlRm9yd2FyZDogZmFsc2UsXHJcbiAgICBtb3ZlUmV0dXJuOiBmYWxzZSxcclxuICAgIG1vdGlvbjogMC45LFxyXG4gICAgcm90YXRlOiAwLFxyXG4gIH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUFzdGVyb2lkcygpIHtcclxuICBhc3Rlcm9pZHMgPSBbXTtcclxuICBsZXQgeCwgeTtcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IEFTVEVST0lEX05VTUJFUiArIGxldmVsOyBpKyspIHtcclxuICAgIGRvIHtcclxuICAgICAgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNhbnZhcy53aWR0aCk7XHJcbiAgICAgIHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjYW52YXMuaGVpZ2h0KTtcclxuICAgIH0gd2hpbGUgKHNhZmV0eUJ1ZmZlcihzaGlwLngsIHNoaXAueSwgeCwgeSkgPCBBU1RFUk9JRF9TSVpFICogMiArIHNoaXAucik7XHJcbiAgICBhc3Rlcm9pZHMucHVzaChuZXdBc3Rlcm9pZCh4LCB5LCBNYXRoLmNlaWwoQVNURVJPSURfU0laRSAvIDIpKSk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBuZXdBc3Rlcm9pZCh4LCB5LCByKSB7XHJcbiAgbGV0IGFzdGVyb2lkTGV2ZWwgPSAxICsgMC4xICogbGV2ZWw7XHJcbiAgbGV0IGFzdGVyb2lkID0ge1xyXG4gICAgeDogeCxcclxuICAgIHk6IHksXHJcbiAgICB2ZXJ0aWNhbGx5OiBNYXRoLnJhbmRvbSgpICogMiArIEFTVEVST0lEX1ZFUlQsXHJcbiAgICB4djpcclxuICAgICAgKChNYXRoLnJhbmRvbSgpICogQVNURVJPSURfU1BFRUQgKiBhc3Rlcm9pZExldmVsKSAvIEZQUykgKlxyXG4gICAgICAoTWF0aC5yYW5kb20oKSA8IDAuNSA/IDEgOiAtMSksXHJcbiAgICB5djpcclxuICAgICAgKChNYXRoLnJhbmRvbSgpICogQVNURVJPSURfU1BFRUQgKiBhc3Rlcm9pZExldmVsKSAvIEZQUykgKlxyXG4gICAgICAoTWF0aC5yYW5kb20oKSA8IDAuNSA/IDEgOiAtMSksXHJcbiAgICByOiByLFxyXG4gICAgYTogTWF0aC5QSSAqIDIsXHJcbiAgICBqYWdnZWRuZXNzOiBbXSxcclxuICB9O1xyXG5cclxuICBmb3IgKGxldCBpID0gMDsgaSA8IEFTVEVST0lEX1ZFUlQ7IGkrKykge1xyXG4gICAgYXN0ZXJvaWQuamFnZ2VkbmVzcy5wdXNoKFxyXG4gICAgICBNYXRoLnJhbmRvbSgpICogQVNURVJPSURfSkFHR0VOREVTUyAqIDIgKyAxIC0gQVNURVJPSURfSkFHR0VOREVTU1xyXG4gICAgKTtcclxuICB9XHJcbiAgcmV0dXJuIGFzdGVyb2lkO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkZXN0cm95QXN0ZXJvaWQoaW5kZXgpIHtcclxuICBsZXQgeCA9IGFzdGVyb2lkc1tpbmRleF0ueDtcclxuICBsZXQgeSA9IGFzdGVyb2lkc1tpbmRleF0ueTtcclxuICBsZXQgciA9IGFzdGVyb2lkc1tpbmRleF0ucjtcclxuICBjcnVzaGluZy5wbGF5KCk7XHJcblxyXG4gIGlmIChyID09IE1hdGguY2VpbChBU1RFUk9JRF9TSVpFIC8gMikpIHtcclxuICAgIHNjb3JlID0gc2NvcmUgKyBQT0lOVFNfRk9SX0xBUkdFX0FTVEVST0lEO1xyXG4gICAgYXN0ZXJvaWRzLnB1c2gobmV3QXN0ZXJvaWQoeCwgeSwgTWF0aC5jZWlsKEFTVEVST0lEX1NJWkUgLyA0KSkpO1xyXG4gICAgYXN0ZXJvaWRzLnB1c2gobmV3QXN0ZXJvaWQoeCwgeSwgTWF0aC5jZWlsKEFTVEVST0lEX1NJWkUgLyA0KSkpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBzY29yZSA9IHNjb3JlICsgUE9JTlRTX0ZPUl9TTUFMTF9BU1RFUk9JRDtcclxuICB9XHJcbiAgYXN0ZXJvaWRzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgaWYgKGFzdGVyb2lkcy5sZW5ndGggPT09IDApIHtcclxuICAgIGxldmVsKys7XHJcbiAgICBuZXh0TGV2ZWwoKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGV4cGxvZGVTaGlwKCkge1xyXG4gIHNoaXAuZXhwbG9hZGluZ1RpbWUgPSBNYXRoLmZsb29yKFNISVBfRVhQTE9ERURVUkFUSU9OICogRlBTKTtcclxuICBzaGlwQmxvd2luZ1VwLnBsYXkoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2FmZXR5QnVmZmVyKHgxLCB5MSwgeDIsIHkyKSB7XHJcbiAgbGV0IGRpc3RhbnNCZXR3ZWVuUG9pbnRzID0gTWF0aC5zcXJ0KFxyXG4gICAgTWF0aC5wb3coeDIgLSB4MSwgMikgKyBNYXRoLnBvdyh5MiAtIHkxLCAyKVxyXG4gICk7XHJcbiAgcmV0dXJuIGRpc3RhbnNCZXR3ZWVuUG9pbnRzO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzaG9vdExhc2VyKCkge1xyXG4gIGlmIChzaGlwLmNhblNob290KSB7XHJcbiAgICBzaGlwLmxhc2Vycy5wdXNoKHtcclxuICAgICAgeDogc2hpcC54ICsgKDQgLyAzKSAqIHNoaXAuciAqIE1hdGguY29zKHNoaXAuYSksXHJcbiAgICAgIHk6IHNoaXAueSAtICg0IC8gMykgKiBzaGlwLnIgKiBNYXRoLnNpbihzaGlwLmEpLFxyXG4gICAgICB4djogKExBU0VSX1NQRUVEICogTWF0aC5jb3Moc2hpcC5hKSkgLyA1MCxcclxuICAgICAgeXY6IC0oTEFTRVJfU1BFRUQgKiBNYXRoLnNpbihzaGlwLmEpKSAvIDUwLFxyXG4gICAgfSk7XHJcbiAgICBzaG9vdC5wbGF5KCk7XHJcbiAgfVxyXG4gIHNoaXAuY2FuU2hvb3QgPSBmYWxzZTtcclxufVxyXG5cclxuZnVuY3Rpb24gVVBEQVRFKCkge1xyXG4gIGxldCBibGlua2luZ09uID0gc2hpcC5ibGlua051bSAlIElOVklTSUJJTElUWSA9PT0gMDtcclxuICBsZXQgZXhwbG9kaW5nID0gc2hpcC5leHBsb2FkaW5nVGltZSA+IDA7XHJcblxyXG4gIC8vIERyYXcgU3BhY2VcclxuICBjdHguZmlsbFN0eWxlID0gXCJibGFja1wiO1xyXG4gIGN0eC5maWxsUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xyXG5cclxuICAvLyBEcmF3IHRoZSBzaGlwXHJcbiAgaWYgKCFleHBsb2RpbmcpIHtcclxuICAgIGlmIChibGlua2luZ09uICYmICFzaGlwLmRlYWQpIHtcclxuICAgICAgZHJhd1NoaXAoc2hpcC54LCBzaGlwLnksIHNoaXAuYSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQmxpbmtpbmcgT25cclxuICAgIGlmIChzaGlwLmJsaW5rTnVtID4gMCkge1xyXG4gICAgICBzaGlwLmJsaW5rVGltZS0tO1xyXG4gICAgICBpZiAoc2hpcC5ibGlua1RpbWUgPT09IDApIHtcclxuICAgICAgICBzaGlwLmJsaW5rVGltZSA9IE1hdGguZmxvb3IoQkxJTksgKiBGUFMpO1xyXG4gICAgICAgIHNoaXAuYmxpbmtOdW0tLTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuICAvLyBFeHBsb2RlIHNoaXBcclxuICBlbHNlIHtcclxuICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgIGN0eC5hcmMoc2hpcC54LCBzaGlwLnksIHNoaXAuciAqIDEsIDcsIE1hdGguUEkgKiAyLCBmYWxzZSk7XHJcbiAgICBjdHguZmlsbCgpO1xyXG4gICAgY3R4LmZpbGxTdHlsZSA9IFwicmVkXCI7XHJcbiAgICBjdHguYmVnaW5QYXRoKCk7XHJcbiAgICBjdHguYXJjKHNoaXAueCwgc2hpcC55LCBzaGlwLnIgKiAxLjQsIE1hdGguUEkgKiAyLCBmYWxzZSk7XHJcbiAgICBjdHguZmlsbCgpO1xyXG4gICAgY3R4LmZpbGxTdHlsZSA9IFwib3JhbmdlXCI7XHJcbiAgICBjdHguYmVnaW5QYXRoKCk7XHJcbiAgICBjdHguYXJjKHNoaXAueCwgc2hpcC55LCBzaGlwLnIgKiAxLjEsIE1hdGguUEkgKiAyLCBmYWxzZSk7XHJcbiAgICBjdHguZmlsbCgpO1xyXG4gICAgY3R4LmZpbGxTdHlsZSA9IFwieWVsbG93XCI7XHJcbiAgICBjdHguYmVnaW5QYXRoKCk7XHJcbiAgICBjdHguYXJjKHNoaXAueCwgc2hpcC55LCBzaGlwLnIgKiAwLjgsIE1hdGguUEkgKiAyLCBmYWxzZSk7XHJcbiAgICBjdHguZmlsbCgpO1xyXG4gICAgY3R4LmZpbGxTdHlsZSA9IFwid2hpdGVcIjtcclxuICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgIGN0eC5hcmMoc2hpcC54LCBzaGlwLnksIHNoaXAuciAqIDAuNSwgTWF0aC5QSSAqIDIsIGZhbHNlKTtcclxuICAgIGN0eC5maWxsKCk7XHJcbiAgfVxyXG5cclxuICAvLyBNb3ZlIGZvcndhcmQgaW4gc3BhY2VcclxuICBpZiAoc2hpcC5tb3ZlRm9yd2FyZCkge1xyXG4gICAgc2hpcC5mb3J3YXJkLnggKz0gKFNISVBfRk9SV0FSRCAqIE1hdGguY29zKHNoaXAuYSkpIC8gMTA7XHJcbiAgICBzaGlwLmZvcndhcmQueSArPSAoU0hJUF9GT1JXQVJEICogTWF0aC5zaW4oc2hpcC5hKSkgLyAxMDtcclxuICAgIHJvY2tldFRocnVzdGVyLnBsYXkoKTtcclxuXHJcbiAgICAvLyBEcmF3IFR1cmJvIEJ1c3RlclxyXG4gICAgaWYgKCFleHBsb2RpbmcgJiYgYmxpbmtpbmdPbikge1xyXG4gICAgICBjdHguZmlsbFN0eWxlID0gYGhzbCgke2h1ZX0sIDEwMCUsIDUwJSlgO1xyXG4gICAgICBjdHguc3Ryb2tlU3R5bGUgPSBcInllbGxvd1wiO1xyXG4gICAgICBjdHgubGluZVdpZHRoID0gU0hJUF9TSVpFIC8gMTU7XHJcbiAgICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgY3R4Lm1vdmVUbyhcclxuICAgICAgICBzaGlwLnggLSBzaGlwLnIgKiAoKDIgLyAzKSAqIE1hdGguY29zKHNoaXAuYSkgKyAwLjcgKiBNYXRoLnNpbihzaGlwLmEpKSxcclxuICAgICAgICBzaGlwLnkgKyBzaGlwLnIgKiAoKDIgLyAzKSAqIE1hdGguc2luKHNoaXAuYSkgLSAwLjcgKiBNYXRoLmNvcyhzaGlwLmEpKVxyXG4gICAgICApO1xyXG4gICAgICBjdHgubGluZVRvKFxyXG4gICAgICAgIHNoaXAueCAtIHNoaXAuciAqIDIgKiBNYXRoLmNvcyhzaGlwLmEpLFxyXG4gICAgICAgIHNoaXAueSArIHNoaXAuciAqIDIgKiBNYXRoLnNpbihzaGlwLmEpXHJcbiAgICAgICk7XHJcbiAgICAgIGN0eC5saW5lVG8oXHJcbiAgICAgICAgc2hpcC54IC0gc2hpcC5yICogKCgyIC8gMykgKiBNYXRoLmNvcyhzaGlwLmEpIC0gMC43ICogTWF0aC5zaW4oc2hpcC5hKSksXHJcbiAgICAgICAgc2hpcC55ICsgc2hpcC5yICogKCgyIC8gMykgKiBNYXRoLnNpbihzaGlwLmEpICsgMC43ICogTWF0aC5jb3Moc2hpcC5hKSlcclxuICAgICAgKTtcclxuICAgICAgY3R4LmNsb3NlUGF0aCgpO1xyXG4gICAgICBjdHguZmlsbCgpO1xyXG4gICAgICBjdHguc3Ryb2tlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vIE1vdmUgcmV0dXJuIGluIHNwYWNlXHJcbiAgZWxzZSBpZiAoc2hpcC5tb3ZlUmV0dXJuICYmIGJsaW5raW5nT24pIHtcclxuICAgIHNoaXAuZm9yd2FyZC55IC09IChTSElQX0ZPUldBUkQgKiBNYXRoLnNpbihzaGlwLmEpKSAvIDEwO1xyXG4gICAgc2hpcC5mb3J3YXJkLnggLT0gKFNISVBfRk9SV0FSRCAqIE1hdGguY29zKHNoaXAuYSkpIC8gMTA7XHJcbiAgICBzaGlwUmV0dXJuLnBsYXkoKTtcclxuXHJcbiAgICAvLyBEcmF3IGJ1c3RlciBpbiByZXR1cm5cclxuICAgIGlmICghZXhwbG9kaW5nKSB7XHJcbiAgICAgIGN0eC5maWxsU3R5bGUgPSBgaHNsKCR7aHVlfSwgMTAwJSwgNTAlKWA7XHJcbiAgICAgIGN0eC5zdHJva2VTdHlsZSA9IFwieWVsbG93XCI7XHJcbiAgICAgIGN0eC5saW5lV2lkdGggPSBTSElQX1NJWkUgLyAxNTtcclxuICAgICAgY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgICBjdHgubW92ZVRvKFxyXG4gICAgICAgIHNoaXAueCAtIHNoaXAuciAqICgoMiAvIDMpICogTWF0aC5jb3Moc2hpcC5hKSArIDAuNyAqIE1hdGguc2luKHNoaXAuYSkpLFxyXG4gICAgICAgIHNoaXAueSArIHNoaXAuciAqICgoMiAvIDMpICogTWF0aC5zaW4oc2hpcC5hKSAtIDAuNyAqIE1hdGguY29zKHNoaXAuYSkpXHJcbiAgICAgICk7XHJcbiAgICAgIGN0eC5saW5lVG8oXHJcbiAgICAgICAgc2hpcC54IC0gc2hpcC5yICogTWF0aC5jb3Moc2hpcC5hKSxcclxuICAgICAgICBzaGlwLnkgKyBzaGlwLnIgKiBNYXRoLnNpbihzaGlwLmEpXHJcbiAgICAgICk7XHJcbiAgICAgIGN0eC5saW5lVG8oXHJcbiAgICAgICAgc2hpcC54IC0gc2hpcC5yICogKCgyIC8gMykgKiBNYXRoLmNvcyhzaGlwLmEpIC0gMC43ICogTWF0aC5zaW4oc2hpcC5hKSksXHJcbiAgICAgICAgc2hpcC55ICsgc2hpcC5yICogKCgyIC8gMykgKiBNYXRoLnNpbihzaGlwLmEpICsgMC43ICogTWF0aC5jb3Moc2hpcC5hKSlcclxuICAgICAgKTtcclxuICAgICAgY3R4LmNsb3NlUGF0aCgpO1xyXG4gICAgICBjdHguZmlsbCgpO1xyXG4gICAgICBjdHguc3Ryb2tlKCk7XHJcbiAgICB9XHJcbiAgfSBlbHNlIHtcclxuICAgIHNoaXAuZm9yd2FyZC54IC09IChzaGlwLm1vdGlvbiAqIHNoaXAuZm9yd2FyZC54KSAvIDU7XHJcbiAgICBzaGlwLmZvcndhcmQueSAtPSAoc2hpcC5tb3Rpb24gKiBzaGlwLmZvcndhcmQueSkgLyA1O1xyXG4gICAgcm9ja2V0VGhydXN0ZXIuc3RvcCgpO1xyXG4gICAgLy8gc2hpcFJldHVybi5zdG9wKCk7XHJcbiAgfVxyXG5cclxuICAvLyBEcmF3IExhc2VyXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLmxhc2Vycy5sZW5ndGg7IGkrKykge1xyXG4gICAgY3R4LmZpbGxTdHlsZSA9IFwibWFnZW50YVwiO1xyXG4gICAgY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgY3R4LmFyYyhcclxuICAgICAgc2hpcC5sYXNlcnNbaV0ueCxcclxuICAgICAgc2hpcC5sYXNlcnNbaV0ueSxcclxuICAgICAgU0hJUF9TSVpFIC8gMixcclxuICAgICAgTWF0aC5QSSAqIDIsXHJcbiAgICAgIDAsXHJcbiAgICAgIHRydWVcclxuICAgICk7XHJcbiAgICBjdHguZmlsbCgpO1xyXG4gIH1cclxuICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXAubGFzZXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBzaGlwLmxhc2Vyc1tpXS54ICs9IHNoaXAubGFzZXJzW2ldLnh2O1xyXG4gICAgc2hpcC5sYXNlcnNbaV0ueSArPSBzaGlwLmxhc2Vyc1tpXS55djtcclxuICB9XHJcblxyXG4gIC8vIERyYXcgbGV2ZWwgdGV4dFxyXG4gIGlmICh0ZXh0QWxwaGEgPj0gMCkge1xyXG4gICAgY3R4LnRleHRBbGlnbiA9IFwiY2VudGVyXCI7XHJcbiAgICBjdHgudGV4dEJhc2VsaW5lID0gXCJtaWRkbGVcIjtcclxuICAgIGN0eC5maWxsU3R5bGUgPSBcInJnYmEoMjAwLCAyMDAsIDIwMCwgXCIgKyB0ZXh0QWxwaGEgKyBcIilcIjtcclxuICAgIGN0eC5mb250ID0gXCJub3JtYWwgMzJweCBhbGdlcmlhbiBcIjtcclxuICAgIGN0eC5maWxsVGV4dCh0ZXh0LCBjYW52YXMud2lkdGggLyAyLCBjYW52YXMuaGVpZ2h0ICogMC4xKTtcclxuICAgIHRleHRBbHBoYSA9IHRleHRBbHBoYSAtIDEuMCAvIFRFWFRfRkFERV9USU1FIC8gRlBTO1xyXG4gIH0gZWxzZSBpZiAoc2hpcC5kZWFkKSB7XHJcbiAgICBuZXdHYW1lKCk7XHJcbiAgfVxyXG5cclxuICAvLyBEcmF3IGxpdmVzXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXZlczsgaSsrKSB7XHJcbiAgICBsaXZlc0NvbG91ciA9IGV4cGxvZGluZyAmJiBpID09PSBsaXZlcyAtIDEgPyBcImdyZWVuXCIgOiBcImxpbWVcIjtcclxuICAgIGRyYXdTaGlwKFxyXG4gICAgICBTSElQX1NJWkUgKyBpICogU0hJUF9TSVpFICogMS4yLFxyXG4gICAgICBTSElQX1NJWkUsXHJcbiAgICAgIDAuNSAqIE1hdGguUEksXHJcbiAgICAgIGxpdmVzQ29sb3VyXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLy8gRHJhdyBTY29yZVxyXG4gIGN0eC50ZXh0QWxpZ24gPSBcInJpZ2h0XCI7XHJcbiAgY3R4LnRleHRCYXNlbGluZSA9IFwicmlnaHRcIjtcclxuICBjdHguZmlsbFN0eWxlID0gXCJyZ2JhKDIwMCwgMjAwLCAyMDApXCI7XHJcbiAgY3R4LmZvbnQgPSBcIm5vcm1hbCAxOHB4IGFyaWFsXCI7XHJcbiAgY3R4LmZpbGxUZXh0KFwiU2NvcmU6IFwiICsgc2NvcmUsIGNhbnZhcy53aWR0aCAtIFNISVBfU0laRSwgU0hJUF9TSVpFKTtcclxuXHJcbiAgLy8gRGV0ZWN0IGxhc2VyIGhpdHMgb24gYXN0ZXJvaWRzXHJcbiAgbGV0IGFzdGVyb2lkX3gsIGFzdGVyb2lkX3ksIGFzdGVyb2lkX3IsIGxhc2VyX3gsIGxhc2VyX3k7XHJcbiAgZm9yIChsZXQgaSA9IGFzdGVyb2lkcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgYXN0ZXJvaWRfeCA9IGFzdGVyb2lkc1tpXS54O1xyXG4gICAgYXN0ZXJvaWRfeSA9IGFzdGVyb2lkc1tpXS55O1xyXG4gICAgYXN0ZXJvaWRfciA9IGFzdGVyb2lkc1tpXS5yO1xyXG5cclxuICAgIGZvciAobGV0IGogPSBzaGlwLmxhc2Vycy5sZW5ndGggLSAxOyBqID49IDA7IGotLSkge1xyXG4gICAgICBsYXNlcl94ID0gc2hpcC5sYXNlcnNbal0ueDtcclxuICAgICAgbGFzZXJfeSA9IHNoaXAubGFzZXJzW2pdLnk7XHJcblxyXG4gICAgICBpZiAoc2FmZXR5QnVmZmVyKGFzdGVyb2lkX3gsIGFzdGVyb2lkX3ksIGxhc2VyX3gsIGxhc2VyX3kpIDwgYXN0ZXJvaWRfcikge1xyXG4gICAgICAgIHNoaXAubGFzZXJzLnNwbGljZShqLCAxKTtcclxuICAgICAgICBkZXN0cm95QXN0ZXJvaWQoaSwgMSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIERyYXcgYXN0ZXJpb2RzXHJcbiAgbGV0IHgsIHksIHIsIGEsIHZlcnQsIGphZ2dlZG5lc3M7XHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhc3Rlcm9pZHMubGVuZ3RoOyBpKyspIHtcclxuICAgIGN0eC5zdHJva2VTdHlsZSA9IGBoc2woJHtodWV9LCAxMDAlLCA1MCUpYDtcclxuICAgIGN0eC5saW5lV2lkdGggPSBTSElQX1NJWkUgLyAyMDtcclxuICAgIHggPSBhc3Rlcm9pZHNbaV0ueDtcclxuICAgIHkgPSBhc3Rlcm9pZHNbaV0ueTtcclxuICAgIGEgPSBhc3Rlcm9pZHNbaV0uYTtcclxuICAgIHIgPSBhc3Rlcm9pZHNbaV0ucjtcclxuICAgIHZlcnQgPSBhc3Rlcm9pZHNbaV0udmVydGljYWxseTtcclxuICAgIGphZ2dlZG5lc3MgPSBhc3Rlcm9pZHNbaV0uamFnZ2VkbmVzcztcclxuICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgIGN0eC5tb3ZlVG8oXHJcbiAgICAgIHggKyByICogamFnZ2VkbmVzc1swXSAqIE1hdGguY29zKGEpLFxyXG4gICAgICB5ICsgciAqIGphZ2dlZG5lc3NbMF0gKiBNYXRoLnNpbihhKVxyXG4gICAgKTtcclxuICAgIGZvciAobGV0IGogPSAxOyBqIDwgdmVydDsgaisrKSB7XHJcbiAgICAgIGN0eC5saW5lVG8oXHJcbiAgICAgICAgeCArIHIgKiBqYWdnZWRuZXNzW2pdICogTWF0aC5jb3MoYSArIChqICogTWF0aC5QSSAqIDIpIC8gdmVydCksXHJcbiAgICAgICAgeSArIHIgKiBqYWdnZWRuZXNzW2pdICogTWF0aC5zaW4oYSArIChqICogTWF0aC5QSSAqIDIpIC8gdmVydClcclxuICAgICAgKTtcclxuICAgIH1cclxuICAgIGN0eC5jbG9zZVBhdGgoKTtcclxuICAgIGN0eC5zdHJva2UoKTtcclxuICB9XHJcblxyXG4gIC8vIENoZWNrIGZvciBjb2xsaXNpb25cclxuICBpZiAoIWV4cGxvZGluZykge1xyXG4gICAgaWYgKHNoaXAuYmxpbmtOdW0gPT09IDApIHtcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhc3Rlcm9pZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICBzYWZldHlCdWZmZXIoc2hpcC54LCBzaGlwLnksIGFzdGVyb2lkc1tpXS54LCBhc3Rlcm9pZHNbaV0ueSkgPFxyXG4gICAgICAgICAgc2hpcC5yICsgYXN0ZXJvaWRzW2ldLnJcclxuICAgICAgICApIHtcclxuICAgICAgICAgIGV4cGxvZGVTaGlwKCk7XHJcbiAgICAgICAgICBkZXN0cm95QXN0ZXJvaWQoaSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBSb3RhdGUgU2hpcFxyXG4gICAgc2hpcC5hID0gc2hpcC5hICsgc2hpcC5yb3RhdGU7XHJcblxyXG4gICAgLy8gTW90aW9uIFNoaXBcclxuICAgIHNoaXAueCA9IHNoaXAueCArIHNoaXAuZm9yd2FyZC54O1xyXG4gICAgc2hpcC55ID0gc2hpcC55IC0gc2hpcC5mb3J3YXJkLnk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHNoaXAuZXhwbG9hZGluZ1RpbWUtLTtcclxuICAgIGlmIChzaGlwLmV4cGxvYWRpbmdUaW1lID09PSAwKSB7XHJcbiAgICAgIGxpdmVzLS07XHJcbiAgICAgIGlmIChsaXZlcyA9PT0gMCkge1xyXG4gICAgICAgIGdhbWVPdmVyKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgc2hpcCA9IG5ld1NoaXAoKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gRWRnZSBvZiBzY3JlZW5cclxuICBpZiAoc2hpcC54IDwgMCAtIHNoaXAucikge1xyXG4gICAgc2hpcC54ID0gY2FudmFzLndpZHRoICsgc2hpcC5yO1xyXG4gIH0gZWxzZSBpZiAoc2hpcC54ID4gY2FudmFzLndpZHRoICsgc2hpcC5yKSB7XHJcbiAgICBzaGlwLnggPSAwIC0gc2hpcC5yO1xyXG4gIH1cclxuICBpZiAoc2hpcC55IDwgMCAtIHNoaXAucikge1xyXG4gICAgc2hpcC55ID0gY2FudmFzLmhlaWdodCArIHNoaXAucjtcclxuICB9IGVsc2UgaWYgKHNoaXAueSA+IGNhbnZhcy5oZWlnaHQgKyBzaGlwLnIpIHtcclxuICAgIHNoaXAueSA9IDAgLSBzaGlwLnI7XHJcbiAgfVxyXG5cclxuICAvLyBNb3ZlIHRoZSBhc3Rlcm9pZHNcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IGFzdGVyb2lkcy5sZW5ndGg7IGkrKykge1xyXG4gICAgYXN0ZXJvaWRzW2ldLnggPSBhc3Rlcm9pZHNbaV0ueCArIGFzdGVyb2lkc1tpXS54diAvIDI7XHJcbiAgICBhc3Rlcm9pZHNbaV0ueSA9IGFzdGVyb2lkc1tpXS55ICsgYXN0ZXJvaWRzW2ldLnl2ICogMjtcclxuXHJcbiAgICAvLyBFZGdlIG9mIHNjcmVlbiBhc3Rlcm9pZHNcclxuICAgIGlmIChhc3Rlcm9pZHNbaV0ueCA8IDAgLSBhc3Rlcm9pZHNbaV0ucikge1xyXG4gICAgICBhc3Rlcm9pZHNbaV0ueCA9IGNhbnZhcy53aWR0aCArIGFzdGVyb2lkc1tpXS5yO1xyXG4gICAgfSBlbHNlIGlmIChhc3Rlcm9pZHNbaV0ueCA+IGNhbnZhcy53aWR0aCArIGFzdGVyb2lkc1tpXS5yKSB7XHJcbiAgICAgIGFzdGVyb2lkc1tpXS54ID0gMCAtIGFzdGVyb2lkc1tpXS5yO1xyXG4gICAgfVxyXG4gICAgaWYgKGFzdGVyb2lkc1tpXS55IDwgMCAtIGFzdGVyb2lkc1tpXS5yKSB7XHJcbiAgICAgIGFzdGVyb2lkc1tpXS55ID0gY2FudmFzLmhlaWdodCArIGFzdGVyb2lkc1tpXS5yO1xyXG4gICAgfSBlbHNlIGlmIChhc3Rlcm9pZHNbaV0ueSA+IGNhbnZhcy5oZWlnaHQgKyBhc3Rlcm9pZHNbaV0ucikge1xyXG4gICAgICBhc3Rlcm9pZHNbaV0ueSA9IDAgLSBhc3Rlcm9pZHNbaV0ucjtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///0\n')}]);